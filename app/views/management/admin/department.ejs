<div class="page-header-block">
    <div class="header-left">
        <h2 class="page-title">Quản lý Khoa & Chuyên ngành</h2>
    </div>
    <div class="header-right">
        <button class="btn-primary-add" id="addDepartmentBtn" type="button">
            <i class="fa-solid fa-plus"></i> Thêm Khoa
        </button>

        <button class="btn-primary-add" id="addMajorBtn" type="button" style="display: none;">
            <i class="fa-solid fa-plus"></i> Thêm Chuyên ngành
        </button>
    </div>
</div>

<!-- Filter Section -->
<div class="main-card filter-card" id="departmentFilterSection">
    <div class="filter-row">
        <div class="filter-item flex-grow-1">
            <label>Tìm kiếm khoa</label>
            <input type="text" id="departmentSearch" class="form-control" placeholder="Tên khoa, mã khoa...">
        </div>
        <div class="filter-item">
            <label>Trạng thái</label>
            <select id="departmentStatusFilter" class="form-control">
                <option value="">Tất cả trạng thái</option>
                <option value="true" selected>Hoạt động</option>
                <option value="false">Không hoạt động</option>
            </select>
        </div>
        <div class="filter-item">
            <button id="searchDepartmentBtn" class="btn-search" type="button">
                <i class="fa-solid fa-search"></i> Tìm kiếm
            </button>
        </div>
    </div>
</div>

<!-- Tabs -->
<div class="staff-tabs mt-20">
    <button class="tab-btn active" id="departmentTab" type="button">
        Khoa (<span id="totalDepartments">0</span>)
    </button>
    <button class="tab-btn" id="majorTab" type="button" style="display: none;">
        Chuyên ngành - <span id="selectedDepartmentName"></span> (<span id="totalMajors">0</span>)
    </button>
</div>

<!-- Department Tab -->
<div id="tab-department" class="tab-pane active">
    <div class="main-card no-top-border">
        <div class="table-responsive">
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>STT</th>
                        <th>Mã khoa</th>
                        <th>Tên khoa</th>
                        <th>Trưởng khoa</th>
                        <th>Liên hệ</th>
                        <th>Địa điểm</th>
                        <th>Giảng viên</th>
                        <th>Trợ lý</th>
                        <th>Chuyên ngành</th>
                        <th>Trạng thái</th>
                        <th class="text-center">Hành động</th>
                    </tr>
                </thead>
                <tbody id="departmentTableBody">
                    <tr><td colspan="10" class="text-center">Đang tải dữ liệu...</td></tr>
                </tbody>
            </table>
        </div>
        <div class="pagination-wrapper" id="pagination-department"></div>
    </div>
</div>

<!-- Major Tab (Hidden by default) -->
<div id="tab-major" class="tab-pane" style="display: none;">
    <!-- Major Filters -->
    <div class="main-card filter-card">
        <div class="filter-row">
            <div class="filter-item">
                <label>Trạng thái</label>
                <select id="majorStatusFilter" class="form-control">
                    <option value="">Tất cả trạng thái</option>
                    <option value="true" selected>Hoạt động</option>
                    <option value="false">Không hoạt động</option>
                </select>
            </div>
            <div class="filter-item">
                <label>Bậc đào tạo</label>
                <select id="majorDegreeFilter" class="form-control">
                    <option value="">Tất cả bậc đào tạo</option>
                    <option value="bachelor">Cử nhân</option>
                    <option value="master">Thạc sĩ</option>
                    <option value="doctoral">Tiến sĩ</option>
                </select>
            </div>
        </div>
    </div>

    <div class="main-card no-top-border">
        <div class="table-responsive">
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>STT</th>
                        <th>Mã chuyên ngành</th>
                        <th>Tên chuyên ngành</th>
                        <th>Bậc đào tạo</th>
                        <th>Số tín chỉ</th>
                        <th>Thời gian (năm)</th>
                        <th>Mô tả</th>
                        <th>Trạng thái</th>
                        <th class="text-center">Hành động</th>
                    </tr>
                </thead>
                <tbody id="majorTableBody">
                    <tr><td colspan="8" class="text-center">Chọn khoa để xem chuyên ngành</td></tr>
                </tbody>
            </table>
        </div>
        <div class="pagination-wrapper" id="pagination-major"></div>
    </div>
</div>

<!-- Department Modal -->
<div id="departmentModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <span class="close-modal-btn" data-modal="department">&times;</span>
        <h3 id="departmentModalTitle" class="modal-title">Thêm Khoa</h3>
        <form id="departmentForm">
            <div class="form-grid-layout">
                <!-- Column 1: Basic Info -->
                <div class="form-col">
                    <h4 style="margin-bottom: 15px; color: #0d6efd;">Thông tin cơ bản</h4>
                    
                    <div class="form-group">
                        <label>Mã Khoa <span class="text-red">*</span></label>
                        <input type="text" name="department_code" id="department_code" class="form-control" placeholder="VD: CNTT" required>
                    </div>

                    <div class="form-group">
                        <label>Tên Khoa <span class="text-red">*</span></label>
                        <input type="text" name="department_name" id="department_name" class="form-control" placeholder="VD: Công nghệ thông tin" required>
                    </div>

                    <div class="form-group">
                        <label>Mô tả</label>
                        <textarea name="description" id="description" class="form-control" rows="4" placeholder="Mô tả về khoa..."></textarea>
                    </div>

                    <div class="form-group">
                        <label>Trạng thái</label>
                        <select name="is_active" id="is_active" class="form-control">
                            <option value="true">Hoạt động</option>
                            <option value="false">Không hoạt động</option>
                        </select>
                    </div>
                </div>

                <!-- Column 2: Contact & Leader Info -->
                <div class="form-col">
                    <h4 style="margin-bottom: 15px; color: #0d6efd;">Thông tin liên hệ</h4>
                    
                    <div class="form-group">
                        <label>Số điện thoại</label>
                        <input type="tel" name="phone" id="phone" class="form-control" placeholder="0123456789">
                    </div>

                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" name="email" id="email" class="form-control" placeholder="department@university.edu.vn">
                    </div>

                    <div class="form-group">
                        <label>Địa điểm</label>
                        <input type="text" name="location" id="location" class="form-control" placeholder="VD: Tòa A, Tầng 3">
                    </div>

                    <div class="form-group">
                        <label>Trưởng khoa</label>
                        <select name="head_lecturer_id" id="head_lecturer_id" class="form-control">
                            <option value="">-- Chọn trưởng khoa --</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="modal-actions-footer">
                <button type="button" class="btn-cancel" data-modal="department">
                    <i class="fa-solid fa-times"></i> Hủy
                </button>
                <button type="submit" class="btn-save">
                    <i class="fa-solid fa-save"></i> Lưu lại
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Major Modal -->
<div id="majorModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <span class="close-modal-btn" data-modal="major">&times;</span>
        <h3 id="majorModalTitle" class="modal-title">Thêm Chuyên ngành</h3>
        <form id="majorForm">
            <div class="form-grid-layout">
                <!-- Column 1: Basic Info -->
                <div class="form-col">
                    <h4 style="margin-bottom: 15px; color: #0d6efd;">Thông tin cơ bản</h4>
                    
                    <div class="form-group">
                        <label>Mã Chuyên ngành <span class="text-red">*</span></label>
                        <input type="text" name="major_code" id="major_code" class="form-control" placeholder="VD: CNPM" required>
                    </div>

                    <div class="form-group">
                        <label>Tên Chuyên ngành <span class="text-red">*</span></label>
                        <input type="text" name="major_name" id="major_name" class="form-control" placeholder="VD: Công nghệ phần mềm" required>
                    </div>

                    <div class="form-group">
                        <label>Bậc đào tạo <span class="text-red">*</span></label>
                        <select name="degree_type" id="degree_type" class="form-control" required>
                            <option value="">-- Chọn bậc đào tạo --</option>
                            <option value="Bachelor">Cử nhân</option>
                            <option value="Master">Thạc sĩ</option>
                            <option value="PhD">Tiến sĩ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Mô tả</label>
                        <textarea name="description" id="major_description" class="form-control" rows="4" placeholder="Mô tả về chuyên ngành..."></textarea>
                    </div>
                </div>

                <!-- Column 2: Academic Info -->
                <div class="form-col">
                    <h4 style="margin-bottom: 15px; color: #0d6efd;">Thông tin đào tạo</h4>
                    
                    <div class="form-group">
                        <label>Số tín chỉ yêu cầu <span class="text-red">*</span></label>
                        <input type="number" name="required_credits" id="required_credits" class="form-control" min="0" placeholder="VD: 120" required>
                    </div>

                    <div class="form-group">
                        <label>Thời gian đào tạo (năm) <span class="text-red">*</span></label>
                        <input type="number" name="duration_years" id="duration_years" class="form-control" min="1" step="0.5" placeholder="VD: 4" required>
                    </div>

                    <div class="form-group">
                        <label>Trạng thái</label>
                        <select name="is_active" id="major_is_active" class="form-control">
                            <option value="true">Hoạt động</option>
                            <option value="false">Không hoạt động</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="modal-actions-footer">
                <button type="button" class="btn-cancel" data-modal="major">
                    <i class="fa-solid fa-times"></i> Hủy
                </button>
                <button type="submit" class="btn-save">
                    <i class="fa-solid fa-save"></i> Lưu lại
                </button>
            </div>
        </form>
    </div>
</div>
<script type="module" src="/js/modules/admin/department/main.js"></script>